# üöó Car Classification Telegram Bot

**Telegram-–±–æ—Ç –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –º–∞—Ä–æ–∫ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π**, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã Computer Vision.

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∑–∞–∫–æ–Ω—á–µ–Ω–Ω–æ–µ ML-—Ä–µ—à–µ–Ω–∏–µ: –æ—Ç –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π (Vision Transformer –∏ ResNet50) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Transfer Learning –¥–æ –¥–µ–ø–ª–æ—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –≤ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º Telegram-–±–æ—Ç–µ.

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∫–ª–∞—Å—Å—ã: `Audi`, `Bentley`, `BMW`, `Porsche`, `Toyota`.

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –∏ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–í —Ö–æ–¥–µ —Ä–∞–±–æ—Ç—ã –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º –±—ã–ª–∏ –æ–±—É—á–µ–Ω—ã –∏ —Å—Ä–∞–≤–Ω–µ–Ω—ã –¥–≤–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã. –û—Å–Ω–æ–≤–Ω–æ–π —Ü–µ–ª—å—é –±—ã–ª–æ –≤—ã—è–≤–∏—Ç—å –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Ç–æ—á–Ω–æ—Å—Ç—å—é —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∏ —Å–∫–æ—Ä–æ—Å—Ç—å—é –æ–±—É—á–µ–Ω–∏—è.

**–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –º–µ—Ç–æ–¥—ã:**
*   **Transfer Learning:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã—Ö –≤–µ—Å–æ–≤ (ImageNet).
*   **Fine-tuning:** –î–≤—É—Ö—ç—Ç–∞–ø–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ (—Å–Ω–∞—á–∞–ª–∞ –æ–±—É—á–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ —Å –∑–∞–º–æ—Ä–æ–∂–µ–Ω–Ω—ã–º "—Ö—Ä–µ–±—Ç–æ–º", –∑–∞—Ç–µ–º —Ä–∞–∑–º–æ—Ä–æ–∑–∫–∞ –∏ –¥–æ–æ–±—É—á–µ–Ω–∏–µ –≤—Å–µ–π —Å–µ—Ç–∏ —Å –Ω–∏–∑–∫–∏–º Learning Rate).
*   **Augmentation:** RandomRotation, HorizontalFlip, ColorJitter.

### –ò—Ç–æ–≥–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ

| Metric | ResNet50 (Baseline) | Vision Transformer (ViT) |
| :--- | :---: | :---: |
| **Test Accuracy** | 85.79% | **92.89%** üèÜ |
| **Test F1-Score** (Weighted) | 0.8551 | **0.9287** üèÜ |
| **Training Time** | 46.26 min | **35.1 min** ‚ö° |
| **Model Size** | **~90 MB** üíæ | 327.4 MB |

> **–í—ã–≤–æ–¥:** –ú–æ–¥–µ–ª—å **Vision Transformer (ViT-base-patch16-224)** –ø–æ–∫–∞–∑–∞–ª–∞ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª–µ–µ –≤—ã—Å–æ–∫—É—é —Ç–æ—á–Ω–æ—Å—Ç—å (~93%) –∏ F1-score –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å ResNet50 (~86%). –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –±–æ–ª—å—à–∏–π —Ä–∞–∑–º–µ—Ä –≤–µ—Å–æ–≤, ViT –æ–±—É—á–∞–ª—Å—è –±—ã—Å—Ç—Ä–µ–µ –∏ –ø–æ–∫–∞–∑–∞–ª –ª—É—á—à—É—é –æ–±–æ–±—â–∞—é—â—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å, –ø–æ—ç—Ç–æ–º—É –∏–º–µ–Ω–Ω–æ –æ–Ω –±—ã–ª –≤—ã–±—Ä–∞–Ω –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞.

---

## üõ† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### Machine Learning & Data Science
*   **PyTorch**: –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–π.
*   **Transformers (Hugging Face)**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ ViT (`google/vit-base-patch16-224`) –∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.
*   **Torchvision**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã ResNet50 –∏ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–π.
*   **Scikit-learn**: –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫ (Confusion Matrix, F1-score, Classification Report) –∏ —Å—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (`train_test_split`).
*   **Pandas / NumPy**: –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –∞–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.
*   **Matplotlib / Seaborn**: –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–±—É—á–µ–Ω–∏—è –∏ –º–∞—Ç—Ä–∏—Ü—ã –æ—à–∏–±–æ–∫.
*   **Pillow (PIL)**: –†–∞–±–æ—Ç–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏.

### Backend & –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
*   **Aiogram 3.x**: –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è Telegram API.
*   **Asyncio**: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ (–∏–Ω—Ñ–µ—Ä–µ–Ω—Å –º–æ–¥–µ–ª–∏ –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –±–æ—Ç–∞).
*   **Pydantic**: –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (`.env`).
*   **Git LFS**: –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ (–≤–µ—Å–∞ –º–æ–¥–µ–ª–∏).

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
car-classification-bot/
‚îú‚îÄ notebooks/                            # Jupyter-–Ω–æ—É—Ç–±—É–∫–∏
‚îÇ  ‚îú‚îÄ vision_transformer.ipynb           # –û–±—É—á–µ–Ω–∏–µ ViT (Production Model)
‚îÇ  ‚îî‚îÄ resnet_training.ipynb              # –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã —Å ResNet50 (Benchmark)
‚îú‚îÄ src/
‚îÇ  ‚îú‚îÄ bot/
‚îÇ  ‚îÇ  ‚îú‚îÄ __init__.py                     # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞
‚îÇ  ‚îÇ  ‚îî‚îÄ handlers.py                     # –õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–æ—Ç–æ –∏ –∫–æ–º–∞–Ω–¥
‚îÇ  ‚îú‚îÄ services/
‚îÇ  ‚îÇ  ‚îî‚îÄ predict.py                      # –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –º–æ–¥–µ–ª–∏
‚îÇ  ‚îú‚îÄ models/
‚îÇ  ‚îÇ  ‚îî‚îÄ vit.py                          # –ö–ª–∞—Å—Å-–æ–±–µ—Ä—Ç–∫–∞ –¥–ª—è ViT (–∑–∞–≥—Ä—É–∑–∫–∞, –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥)
‚îÇ  ‚îú‚îÄ utils/
‚îÇ  ‚îÇ  ‚îî‚îÄ image_loader.py                 # –£—Ç–∏–ª–∏—Ç—ã –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îÇ  ‚îú‚îÄ main.py                            # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (Entry point)
‚îÇ  ‚îî‚îÄ config.py                          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ Pydantic
‚îú‚îÄ saved_models/
‚îÇ  ‚îî‚îÄ vit_model.pth                      # –í–µ—Å–∞ –º–æ–¥–µ–ª–∏ (—Ö—Ä–∞–Ω—è—Ç—Å—è –≤ Git LFS)
‚îú‚îÄ requirements.txt                      # –°–ø–∏—Å–æ–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
‚îú‚îÄ .env                                  # –®–∞–±–ª–æ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îî‚îÄ README.md
```
üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫
–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Git LFS –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤–µ—Å–æ–≤ –º–æ–¥–µ–ª–∏. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–Ω —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–µ—Ä–µ–¥ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º.

1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
bash
git lfs install
git clone https://github.com/–í–ê–®_–ù–ò–ö/car-classification-bot.git
cd car-classification-bot
2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Python 3.9+.

bash
# Windows
python -m venv venv
.\venv\Scripts\activate

# Linux / macOS
python3 -m venv venv
source venv/bin/activate
3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
bash
pip install -r requirements.txt
4. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .env –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∏–º–µ—Ä–∞:

bash
# –°–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª .env –∏ –ø—Ä–æ–ø–∏—Å—ã–≤–∞–µ–º —Ç—É–¥–∞:
BOT_TOKEN=your_telegram_bot_token_here
VIT_MODEL_PATH=saved_models/vit_model.pth
(–¢–æ–∫–µ–Ω –±–æ—Ç–∞ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —É @BotFather –≤ Telegram)

5. –ó–∞–ø—É—Å–∫
bash
python src/main.py
–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç –≥–æ—Ç–æ–≤ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π.
